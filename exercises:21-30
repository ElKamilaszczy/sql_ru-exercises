-- Exercise 21 - Computer firm

Select p.maker, max(pc.price)
from product p join pc pc on pc.model = p.model
group by p.maker

-- Exercise 22 - Computer firm

Select speed, avg(price) from pc where speed > 600
group by speed

-- Exercise 23 - COmputer firm
Get the makers producing both PCs having a speed of 750 MHz or higher and laptops with a speed of 750 MHz or higher. 

select p.maker from product p
join pc pc on p.model = pc.model where pc.speed >= 750
intersect
select p.maker from product p
join laptop l on p.model = l.model where l.speed >= 75

-- Exercise 24 - Computer firm
List the models of any type having the highest price of all products present in the database. 

with all_products as
(
 select model, price from pc
union all
select model, price from laptop
union all
select model, price from printer
)
select model from all_products where price
= (select max(price) from all_products)
group by model

-- Exercise 25 - Computer
Find the printer makers also producing PCs with the lowest RAM capacity and the highest processor speed of all PCs having the lowest RAM capacity.

Select pro.maker from product pro where 
exists (
   select null from product pro1
   where pro1.maker = pro.maker and pro1.type='Printer'
)
and exists (
   select null from product pro1
   where pro1.maker = pro.maker and pro1.type='PC'
) and pro.model in
(
   select  pc1.model from pc pc1
  where pc1.speed = (select max(speed) from pc where ram = 
(select min(ram) from pc))
 and ram = (select min(ram) from pc)
)
group by pro.maker;

select distinct pro.maker from product pro
where pro.type = 'Printer' and pro.maker in (
   select pro1.maker from product pro1 inner join pc pc
on pro1.model = pc.model where pc.ram = (select min(ram) from pc) and pc.speed = (select max(speed) from pc where ram = (select min(ram) from pc)
)
)

The first solution is actually better in terms of performance. We are checking whether specific maker has produced any pc and printer. Then we check if this model is in the list of pc models, which have to fulfill several predicates.

--Exercise 26--
Find out the average price of PCs and laptops produced by maker A.

Select avg(price) as price from
(
 select price from product p join pc pc on p.model = pc.model
and p.maker='A' 
union all
 select price from product p join laptop l on p.model = l.model
and p.maker='A'
) as p

-- Exercise 27 -- Computer firm
Find out the average hard disk drive capacity of PCs produced by makers who also manufacture printers.

Select pro.maker, avg(hd)
from product pro inner join pc pc on pro.model = pc.model where pro.maker in
(select maker from product where type='PC')
and  pro.maker in (select maker from product where type='Printer')
group by pro.maker

-- Exercise 28 - 
Using Product table, find out the number of makers who produce only one model.

with one_model as
(
 select maker, count(*) as cnt from product
group by maker
having count(*) = 1
)
select count(*) from one_model;

-- Exercise 29  - Recycling firm
Under the assumption that receipts of money (inc) and payouts (out) are registered not more than once a day for each collection point [i.e. the primary key consists of (point, date)], write a query displaying cash flow data (point, date, income, expense)

select point, date, sum(income), sum(outcome) from
(
select point, date, inc as income, null as outcome from income_o
union all
select point, date, null as income, out as outcome from outcome_o
) as x
group by point, date

-- Exercise 30 - Recycling firm
Under the assumption that receipts of money (inc) and payouts (out) are registered not more than once a day for each collection point [i.e. the primary key consists of (point, date)], write a query displaying cash flow data (point, date, income, expense)

select x.point ,x.date, sum(x.outcome) outcome,sum(x.income)income from 
(
select i.point,i.date,null outcome , i.inc income from income i 
union all 
select o.point,o.date,o.out outcome ,null income from outcome o
) x
group by x.point,x.date
order by x.point,x.date




















































